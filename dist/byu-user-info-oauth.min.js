const EVENT_PREFIX="byu-browser-oauth",STATE_CHANGE_EVENT=`${EVENT_PREFIX}-state-changed`,LOGIN_REQUESTED_EVENT=`${EVENT_PREFIX}-login-requested`,LOGOUT_REQUESTED_EVENT=`${EVENT_PREFIX}-logout-requested`,STATE_REQUESTED_EVENT=`${EVENT_PREFIX}-state-requested`,STATE_INDETERMINATE="indeterminate",STATE_UNAUTHENTICATED="unauthenticated",STATE_AUTHENTICATED="authenticated";let store={state:STATE_INDETERMINATE},observer=onStateChange(e=>{store=e});function onStateChange(e){const t=function(t){e(t.detail)};return document.addEventListener(STATE_CHANGE_EVENT,t,!1),store.state===STATE_INDETERMINATE?dispatch(STATE_REQUESTED_EVENT,{callback:e}):e(store),{offStateChange:function(){document.removeEventListener(STATE_CHANGE_EVENT,t,!1)}}}function login(){const e=promiseState([STATE_AUTHENTICATED]);return dispatch(LOGIN_REQUESTED_EVENT),e}function logout(){const e=promiseState([STATE_UNAUTHENTICATED]);return dispatch(LOGOUT_REQUESTED_EVENT),e}function promiseState(e){return window.Promise?new Promise((t,n)=>{const E=onStateChange(({state:o,token:s,user:r,error:a})=>{a?(n(a),E.offStateChange()):e.indexOf(o)>=0&&(t({state:o,token:s,user:r}),E.offStateChange())})}):null}function dispatch(e,t){let n;"function"==typeof window.CustomEvent?n=new CustomEvent(e,{detail:t}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!1,t),document.dispatchEvent(n)}class ByuUserInfoOAuth extends HTMLElement{constructor(){super()}connectedCallback(){renderEmpty(this),this._observer=onStateChange(e=>this.authStateChanged(e))}disconnectedCallback(){this._observer&&this._observer.offStateChange(),this._userInfo=null}authStateChanged({state:e,token:t,user:n,error:E}){const o=this._userInfo.querySelector('[slot="user-name"]'),s=!!o;if(n){const e=s?o:this.ownerDocument.createElement("span");e.setAttribute("slot","user-name"),e.innerText=n.name.givenName,s||this._userInfo.appendChild(e)}else s&&this._userInfo.removeChild(o)}}function renderEmpty(e){const t=e.ownerDocument,n=t.createElement("byu-user-info");e._userInfo=n;const E=t.createElement("a");E.innerText="Sign In",E.setAttribute("slot","login"),E.addEventListener("click",()=>{login()});const o=t.createElement("a");o.innerText="Sign Out",o.setAttribute("slot","logout"),o.addEventListener("click",()=>{logout()}),n.appendChild(E),n.appendChild(o),e.appendChild(n)}window.customElements.define("byu-user-info-oauth",ByuUserInfoOAuth);export default ByuUserInfoOAuth;
//# sourceMappingURL=byu-user-info-oauth.min.js.map
